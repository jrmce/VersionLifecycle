<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Environments</h1>
    <button
      (click)="onCreateClick()"
      class="px-4 py-2 bg-linear-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all shadow-md font-medium cursor-pointer"
      [disabled]="loading()"
    >
      Create Environment
    </button>
  </div>

  @if (error()) {
    <div class="mb-4 p-4 bg-red-50 border border-red-200 rounded-md flex justify-between items-start">
      <p class="text-red-800">{{ error() }}</p>
      <button
        (click)="onClearError()"
        class="text-red-600 hover:text-red-800 cursor-pointer"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
  }

  @if (loading()) {
    <div class="flex justify-center items-center py-12">
      <div class="text-center">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mb-4"></div>
        <p class="text-gray-600">Loading environments...</p>
      </div>
    </div>
  } @else if (environments().length === 0) {
    <div class="text-center py-16 bg-white rounded-xl shadow-sm border border-gray-200">
      <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
      </svg>
      <h3 class="text-gray-500 text-lg">No environments</h3>
      <p class="mt-1 text-sm text-gray-400">Get started by creating a new environment.</p>
      <button
        (click)="onCreateClick()"
        class="mt-4 px-4 py-2 bg-linear-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all shadow-md font-medium"
      >
        Create Environment
      </button>
    </div>
  } @else {
    <div class="bg-white shadow-md rounded-lg overflow-hidden">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Order</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          @for (env of environments(); track env.id) {
            <tr class="hover:bg-gray-50">
              @if (editingId === env.id) {
                <td class="px-6 py-4 whitespace-nowrap">
                  <input
                    type="number"
                    [(ngModel)]="editOrder"
                    class="w-20 px-2 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    min="0"
                  />
                </td>
                <td class="px-6 py-4">
                  <input
                    type="text"
                    [(ngModel)]="editName"
                    class="w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Environment name"
                  />
                </td>
                <td class="px-6 py-4">
                  <input
                    type="text"
                    [(ngModel)]="editDescription"
                    class="w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="Description (optional)"
                  />
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <button
                    (click)="saveEdit(env.id)"
                    class="text-green-600 hover:text-green-900 mr-3 cursor-pointer"
                    [disabled]="!editName.trim()"
                  >
                    Save
                  </button>
                  <button
                    (click)="cancelEdit()"
                    class="text-gray-600 hover:text-gray-900 cursor-pointer"
                  >
                    Cancel
                  </button>
                </td>
              } @else {
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  {{ env.order }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                  {{ env.name }}
                </td>
                <td class="px-6 py-4 text-sm text-gray-500">
                  {{ env.description || 'â€”' }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <button
                    (click)="startEdit(env)"
                    class="text-blue-600 hover:text-blue-900 mr-3 cursor-pointer"
                  >
                    Edit
                  </button>
                  <button
                    (click)="onDeleteEnvironment(env.id)"
                    class="text-red-600 hover:text-red-900 cursor-pointer"
                  >
                    Delete
                  </button>
                </td>
              }
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
